<!-- <!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1"
        <link rel="stylesheet" href="style.css">
        <link rel="stylesheet" href="bootstrap-grid.css">
        <title>Bus & Weather App</title>
    </head>
    <body>

    </body>
    <script src="jQuery.js"></script>
    <script src="bootstrap.bundle.js"></script>
    <script src="script.js"></script>
</html> !-->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Leaflet</title>

    <script src="https://code.jquery.com/jquery-3.5.0.min.js"
        integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin="" />

    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
        integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
        crossorigin=""></script>
    <!-- define a height for map container-->
    <style>
        #mapid {
            height: 400px;
            width: 400px;
        }
    </style>

</head>

<body>
    <div style="max-width:750px;width:100%;">
        <div id="mapid" style="float:left;"></div>
        <div id="my-coordinates" style="float:right;">
            <!-- define current lat long based on user settings-->
            <div>Latitude: <span id="lat"></span></div>
            <div>Longitude: <span id="lng"></span></div>
            <input id="createMarker" type="button" value="Create Marker & zoom to location">
            <input id="toggleZoom" type="button" value="Toggle Zoom">

        </div>
        <!-- place leaflet/map container .. take note of the id used-->

        <script type="text/javascript">
            var latlng = [];
            var getIPApi = $.getJSON("https://ipapi.co/json", function () {
                console.log("success");
            }).done(function (response) {
                latlng["lat"] = response.latitude;
                latlng["lng"] = response.longitude;
                console.log(`Latitude: ${latlng["lat"]}`);
                console.log(`Longitude: ${latlng["lat"]}`);
                //update html
                $("#lat").html(latlng["lat"]);
                $("#lng").html(latlng["lng"]);

            }).fail(function () {

            }).always(function () {

            });
            console.log(getIPApi);

            var mymap = L.map('mapid')
            //Make sure all the code is called after the div and leaflet.js inclusion. 
            //That’s it! You have a working Leaflet map now.
            //this portion of the script exist after the map container (mapid) 
            //{z}{x}{y} are coordinates used by mapbox n leaflet 
            //@2x taps onto retina display
            mymap.setView([51.505, -0.09], 13);
            L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}@2x?access_token={accessToken}', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                maxZoom: 18,//map zoom level //https://leafletjs.com/examples/zoom-levels/
                id: 'mapbox/streets-v11', //https://docs.mapbox.com/api/maps/#static-tiles // 5,000 requests per minute. 
                tileSize: 512, //map tile size
                zoomOffset: -1,
                accessToken: 'pk.eyJ1IjoibWFsY29sbXlhbTM4IiwiYSI6ImNrOWVhYTB2YjAwNnczZ280MDgwazZoaTQifQ.P6wyIWSyIxDz4_Xc8jhesA' //get mapbox public access token
            }).addTo(mymap);


            var marker = L.marker([51.5, -0.09]).addTo(mymap);

            //Adding a circle is the same (except for specifying the radius in meters as a second argument), 
            //but lets you control how it looks by passing options as the last argument when creating 
            //the object:
            var circle = L.circle([51.508, -0.11], {
                color: 'red',
                fillColor: '#f03',
                fillOpacity: 0.5,
                radius: 500
            }).addTo(mymap);

            var polygon = L.polygon([
                [51.509, -0.08],
                [51.503, -0.06],
                [51.51, -0.047]
            ]).addTo(mymap);

            marker.bindPopup("<b>Hello world!</b><br>I am a popup.").openPopup();
            circle.bindPopup("I am a circle.");
            polygon.bindPopup("I am a polygon.");

            mymap.panTo([50, 30]);

            $("#createMarker").on("click", function (e) {
                e.preventDefault();
                console.log("button Pressed");
                createMarker(latlng["lat"], latlng["lng"], mymap, "My Current Location", true);
            });

            //store all markers
            var markerList = [];

            function createMarker(lat, lng, map, popupMsg = "", openPopup = false) {
                var tempMarker = L.marker([lat, lng]).addTo(map);
                console.log(`Marker created at: ${lat},${lng}`);
                map.panTo([lat, lng]);
                markerList.push[tempMarker];

                //create popup
                if (popupMsg !== "") {
                    if (openPopup) {
                        tempMarker.bindPopup(popupMsg).openPopup();
                    } else {
                        tempMarker.bindPopup(popupMsg);
                    }
                }
            }

            function toggleZoom() {

                console.log("hi");
                //console.log("zoom" + mymap.zoomControl.enable());
                // mymap.zoomControl.disable();// false;//false });

            }
            toggleZoom();

            //some common functions
            //mymap.setZoom(13);
            //console.log(mymap.setZoom(0));

            //https://leafletjs.com/reference-1.6.0.html#map-methods-for-getting-map-state
            console.log(`Get Zoom: ${mymap.getZoom()}`);
            console.log(`Get Center: ${mymap.getCenter()}`);
            console.log(`Get Bounds: ${mymap.getBounds()}`);
            console.log(`Get MinZoom: ${mymap.getMinZoom()}`);
            console.log(`Get MaxZoom: ${mymap.getMaxZoom()}`);
            console.log(`Get Size: ${mymap.getSize()}`);
            console.log(`Get MaxZoom: ${mymap.getMaxZoom()}`);


            function onEachFeature(feature, layer) {
                // does this feature have a property named popupContent?
                if (feature.properties && feature.properties.popupContent) {
                    layer.bindPopup(feature.properties.popupContent);
                }
            }
            
            //use onemap to reverse geocode 
            //createMarker(1.2865006247607813,103.83788672656203,mymap,"carpkar",true);
            
            /*
            $(function () {
                $('#search-btn').click(function () {
                    $.ajax(apiURL, {
                        params: {
                            apikey: apiKey,
                            'function': 'ÏSYMBOL_SEARCH',
                            keywords: $('#search-terms').val()
                        }
                    }).done(function (response) {
                        console.log(response.data);
                    })
                })
            })*/
            /* WIP
            var geojsonFeature = {
                "type": "Feature",
                "properties": {
                    "name": "Coors Field",
                    "amenity": "Baseball Stadium",
                    "popupContent": "BLKS 462A, 462B YISHUN AVENUE 6"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [29832.1087	,45462.7555	]
                }
            };

            L.geoJSON(geojsonFeature, {
                onEachFeature: onEachFeature
            }).addTo(mymap);
            */

            //L.GeoJSON.coordsToLatLng() 
            //L.geoJSON.coordsToLatLng([29832.1087	,45462.7555]);

        //remove zoom control
        //mymap.removeControl(mymap.zoomControl);
        //mymap.touchZoom.disable();
        //mymap.doubleClickZoom.disable();
        //mymap.scrollWheelZoom.disable();
        //mymap.boxZoom.disable();
        //mymap.keyboard.disable();
        //$(".leaflet-control-zoom").css("visibility", "hidden");
        </script>

</body>

</html>